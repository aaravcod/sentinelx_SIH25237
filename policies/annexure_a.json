{
  "version": "4.0",
  "rules": [
    {
      "id": "WIN-1-a-i",
      "name": "Enforce password history",
      "description": "Ensure password history is 24 or more",
      "severity": "High",
      "platform": "windows",
      "type": "command",
      "tags": ["account"],
      "check": { "cmd": "powershell", "args": ["net accounts | findstr /C:\"Length of password history maintained\""], "expect_pattern": "24" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["net accounts /uniquepw:24"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["net accounts /uniquepw:0"] }
    },
    {
      "id": "WIN-1-a-ii",
      "name": "Maximum password age",
      "description": "Ensure Maximum password age is 90 days",
      "severity": "Medium",
      "platform": "windows",
      "type": "command",
      "tags": ["account"],
      "check": { "cmd": "powershell", "args": ["net accounts | findstr /C:\"Maximum password age\""], "expect_pattern": "90" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["net accounts /maxpwage:90"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["net accounts /maxpwage:unlimited"] }
    },
    {
      "id": "WIN-1-a-iii",
      "name": "Minimum password age",
      "description": "Ensure Minimum password age is 1 day",
      "severity": "Medium",
      "platform": "windows",
      "type": "command",
      "tags": ["account"],
      "check": { "cmd": "powershell", "args": ["net accounts | findstr /C:\"Minimum password age\""], "expect_pattern": "1" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["net accounts /minpwage:1"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["net accounts /minpwage:0"] }
    },
    {
      "id": "WIN-1-a-iv",
      "name": "Minimum password length",
      "description": "Ensure Minimum password length is 12 characters",
      "severity": "High",
      "platform": "windows",
      "type": "command",
      "tags": ["account"],
      "check": { "cmd": "powershell", "args": ["net accounts | findstr /C:\"Minimum password length\""], "expect_pattern": "12" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["net accounts /minpwlen:12"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["net accounts /minpwlen:0"] }
    },
    {
      "id": "WIN-1-b-i",
      "name": "Account lockout duration",
      "description": "Ensure Account lockout duration is 15 minutes",
      "severity": "Medium",
      "platform": "windows",
      "type": "command",
      "tags": ["lockout"],
      "check": { "cmd": "powershell", "args": ["net accounts | findstr /C:\"Lockout duration\""], "expect_pattern": "15" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["net accounts /lockoutduration:15"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["net accounts /lockoutduration:30"] }
    },
    {
      "id": "WIN-1-b-ii",
      "name": "Account lockout threshold",
      "description": "Ensure Account lockout threshold is 5 attempts",
      "severity": "High",
      "platform": "windows",
      "type": "command",
      "tags": ["lockout"],
      "check": { "cmd": "powershell", "args": ["net accounts | findstr /C:\"Lockout threshold\""], "expect_pattern": "5" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["net accounts /lockoutthreshold:5"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["net accounts /lockoutthreshold:0"] }
    },
    {
      "id": "WIN-3-b-vi",
      "name": "Disable Windows Script Host",
      "description": "Ensure Windows Script Host (WSH) is disabled to prevent malware",
      "severity": "High",
      "platform": "windows",
      "type": "registry",
      "tags": ["attack_surface"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows Script Host\\Settings", "reg_value": "Enabled", "expected": 0 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows Script Host\\Settings", "reg_value": "Enabled", "value": 0 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows Script Host\\Settings", "reg_value": "Enabled", "value": 1 }
    },
    {
      "id": "WIN-4-a-vi",
      "name": "Disable PowerShell 2.0",
      "description": "Ensure legacy PowerShell 2.0 is disabled",
      "severity": "High",
      "platform": "windows",
      "type": "registry",
      "tags": ["attack_surface"],
      "check": {
        "reg_key": "HKLM\\SOFTWARE\\Microsoft\\PowerShell\\1\\PowerShellEngine",
        "reg_value": "PowerShellVersion",
        "expected": "5.1"
      },
      "remediation": {
        "type": "registry",
        "reg_key": "HKLM\\SOFTWARE\\Microsoft\\PowerShell\\1\\PowerShellEngine",
        "reg_value": "PowerShellVersion",
        "value": "5.1"
      },
      "rollback": {
        "type": "registry",
        "reg_key": "HKLM\\SOFTWARE\\Microsoft\\PowerShell\\1\\PowerShellEngine",
        "reg_value": "PowerShellVersion",
        "value": "2.0"
      }
    },
    {
      "id": "WIN-1-a-vi",
      "name": "Store Passwords Reversible",
      "description": "Ensure 'Store passwords using reversible encryption' is Disabled",
      "severity": "Critical",
      "platform": "windows",
      "type": "command",
      "tags": ["account"],
      "check": { "cmd": "powershell", "args": ["Get-ItemProperty HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa | Select-Object -ExpandProperty ClearTextPassword"], "expect_pattern": "0" },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa", "reg_value": "ClearTextPassword", "value": 0 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa", "reg_value": "ClearTextPassword", "value": 1 }
    },
    {
      "id": "WIN-3-a-i",
      "name": "Block Microsoft accounts",
      "description": "Ensure Accounts: Block Microsoft accounts is Enabled",
      "severity": "Medium",
      "platform": "windows",
      "type": "registry",
      "tags": ["security_options"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "NoConnectedUser", "expected": 3 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "NoConnectedUser", "value": 3 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "NoConnectedUser", "value": 0 }
    },
    {
      "id": "WIN-3-a-ii",
      "name": "Guest account status",
      "description": "Ensure Guest account status is Disabled",
      "severity": "High",
      "platform": "windows",
      "type": "command",
      "tags": ["security_options"],
      "check": { "cmd": "net", "args": ["user", "Guest"], "expect_pattern": "Account active               No" },
      "remediation": { "type": "command", "cmd": "net", "args": ["user", "Guest", "/active:no"] },
      "rollback": { "type": "command", "cmd": "net", "args": ["user", "Guest", "/active:yes"] }
    },
    {
      "id": "WIN-3-a-iv",
      "name": "Rename Administrator",
      "description": "Ensure Administrator account is renamed",
      "severity": "Medium",
      "platform": "windows",
      "type": "command",
      "tags": ["security_options"],
      "check": { "cmd": "wmic", "args": ["useraccount", "where", "name='Administrator'", "get", "name"], "expect_pattern": "Administrator" },
      "remediation": { "type": "manual", "cmd": "echo", "args": ["Use: wmic useraccount where name='Administrator' rename 'SuperUser'"] },
      "rollback": { "type": "manual", "cmd": "echo", "args": ["Rename back to Administrator"] }
    },
    {
      "id": "WIN-3-b-i",
      "name": "Disable CTRL+ALT+DEL",
      "description": "Ensure Interactive logon: Do not require CTRL+ALT+DEL is Disabled",
      "severity": "Medium",
      "platform": "windows",
      "type": "registry",
      "tags": ["security_options"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "DisableCAD", "expected": 0 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "DisableCAD", "value": 0 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "DisableCAD", "value": 1 }
    },
    {
      "id": "WIN-3-b-vi",
      "name": "Disable Windows Script Host",
      "description": "Ensure Windows Script Host is disabled (Malware prevention)",
      "severity": "High",
      "platform": "windows",
      "type": "registry",
      "tags": ["attack_surface"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows Script Host\\Settings", "reg_value": "Enabled", "expected": 0 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows Script Host\\Settings", "reg_value": "Enabled", "value": 0 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows Script Host\\Settings", "reg_value": "Enabled", "value": 1 }
    },
    {
      "id": "WIN-3-c-i",
      "name": "MS Server Idle Time",
      "description": "Amount of idle time required before suspending session (15 mins)",
      "severity": "Medium",
      "platform": "windows",
      "type": "registry",
      "tags": ["network"],
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters", "reg_value": "autodisconnect", "expected": 15 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters", "reg_value": "autodisconnect", "value": 15 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters", "reg_value": "autodisconnect", "value": 45 }
    },
    {
      "id": "WIN-3-c-iv",
      "name": "No Anon SAM Enumeration",
      "description": "Do not allow anonymous enumeration of SAM accounts",
      "severity": "High",
      "platform": "windows",
      "type": "registry",
      "tags": ["network"],
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa", "reg_value": "RestrictAnonymousSAM", "expected": 1 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa", "reg_value": "RestrictAnonymousSAM", "value": 1 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa", "reg_value": "RestrictAnonymousSAM", "value": 0 }
    },
    {
      "id": "WIN-3-d-ii",
      "name": "No LanMan Hash",
      "description": "Do not store LAN Manager hash value on next password change",
      "severity": "Critical",
      "platform": "windows",
      "type": "registry",
      "tags": ["network"],
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa", "reg_value": "NoLMHash", "expected": 1 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa", "reg_value": "NoLMHash", "value": 1 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa", "reg_value": "NoLMHash", "value": 0 }
    },
    {
      "id": "WIN-3-d-iv",
      "name": "NTLM Client Security",
      "description": "Minimum session security for NTLM SSP clients (128-bit)",
      "severity": "High",
      "platform": "windows",
      "type": "registry",
      "tags": ["network"],
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0", "reg_value": "NtlmMinClientSec", "expected": 537395200 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0", "reg_value": "NtlmMinClientSec", "value": 537395200 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0", "reg_value": "NtlmMinClientSec", "value": 0 }
    },
    {
      "id": "WIN-3-b-ii",
      "name": "Dont display last user",
      "description": "Ensure Interactive logon: Dont display last signed in is Enabled",
      "severity": "Medium",
      "platform": "windows",
      "type": "registry",
      "tags": ["security_options"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "DontDisplayLastUserName", "expected": 1 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "DontDisplayLastUserName", "value": 1 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "DontDisplayLastUserName", "value": 0 }
    },
    {
      "id": "WIN-3-b-v",
      "name": "Logon Message Text",
      "description": "Configure Interactive logon: Message text",
      "severity": "Low",
      "platform": "windows",
      "type": "registry",
      "tags": ["security_options"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "LegalNoticeText", "expected": "Authorized Use Only" },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "LegalNoticeText", "value": "Authorized Use Only" },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "LegalNoticeText", "value": "" }
    },
    {
      "id": "WIN-4-a-i",
      "name": "UAC Admin Approval",
      "description": "Ensure UAC Admin Approval Mode is Enabled",
      "severity": "High",
      "platform": "windows",
      "type": "registry",
      "tags": ["uac"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "FilterAdministratorToken", "expected": 1 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "FilterAdministratorToken", "value": 1 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "FilterAdministratorToken", "value": 0 }
    },
    {
      "id": "WIN-4-b-i",
      "name": "Disable Bluetooth Audio",
      "description": "Stop Audio Services immediately (Visual Check: Red X on Speaker)",
      "severity": "Low",
      "platform": "windows",
      "type": "command",
      "tags": ["services", "demo_hero"],
      "check": { 
        "cmd": "powershell", 
        "args": ["Get-Service -Name Audiosrv | Select-Object -ExpandProperty Status"], 
        "expect_pattern": "Stopped" 
      },
      "remediation": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Stop-Service -Name Audiosrv -Force"] 
      },
      "rollback": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Start-Service -Name Audiosrv"] 
      }
    },
    {
      "id": "WIN-4-b-ii",
      "name": "Disable Bluetooth Support",
      "description": "Ensure Bluetooth Support Service is Disabled AND Stopped",
      "severity": "Low",
      "platform": "windows",
      "type": "command",
      "tags": ["services", "demo_hero"],
      "check": { 
        "cmd": "powershell", 
        "args": ["Get-Service -Name bthserv | Select-Object -ExpandProperty Status"], 
        "expect_pattern": "Stopped" 
      },
      "remediation": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Set-Service -Name bthserv -StartupType Disabled; Stop-Service -Name bthserv -Force"] 
      },
      "rollback": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Set-Service -Name bthserv -StartupType Manual; Start-Service -Name bthserv"] 
      }
    },
    {
      "id": "WIN-4-b-x",
      "name": "Disable Remote Registry",
      "description": "Ensure Remote Registry is Disabled",
      "severity": "Critical",
      "platform": "windows",
      "type": "registry",
      "tags": ["services"],
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\RemoteRegistry", "reg_value": "Start", "expected": 4 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\RemoteRegistry", "reg_value": "Start", "value": 4 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\RemoteRegistry", "reg_value": "Start", "value": 3 }
    },
    {
      "id": "WIN-4-b-xiii",
      "name": "Disable SNMP Service",
      "description": "Ensure SNMP Service is Disabled",
      "severity": "High",
      "platform": "windows",
      "type": "registry",
      "tags": ["services"],
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SNMP", "reg_value": "Start", "expected": 4 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SNMP", "reg_value": "Start", "value": 4 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SNMP", "reg_value": "Start", "value": 3 }
    },
    {
      "id": "WIN-4-b-xiv",
      "name": "Disable UPnP Device Host",
      "description": "Ensure UPnP Device Host is Disabled",
      "severity": "Medium",
      "platform": "windows",
      "type": "registry",
      "tags": ["services"],
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\upnphost", "reg_value": "Start", "expected": 4 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\upnphost", "reg_value": "Start", "value": 4 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\upnphost", "reg_value": "Start", "value": 3 }
    },
    {
      "id": "WIN-4-b-xxiii",
      "name": "Disable Xbox Accessory",
      "description": "Ensure XboxGipSvc is Disabled",
      "severity": "Low",
      "platform": "windows",
      "type": "registry",
      "tags": ["services"],
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\XboxGipSvc", "reg_value": "Start", "expected": 4 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\XboxGipSvc", "reg_value": "Start", "value": 4 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\XboxGipSvc", "reg_value": "Start", "value": 3 }
    },
    {
      "id": "WIN-4-b-xxiv",
      "name": "Disable Xbox Live Auth",
      "description": "Ensure XblAuthManager is Disabled",
      "severity": "Low",
      "platform": "windows",
      "type": "registry",
      "tags": ["services"],
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\XblAuthManager", "reg_value": "Start", "expected": 4 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\XblAuthManager", "reg_value": "Start", "value": 4 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\XblAuthManager", "reg_value": "Start", "value": 3 }
    },
    {
      "id": "WIN-4-b-xxvi",
      "name": "Disable Xbox Networking",
      "description": "Kill Xbox Live Networking Service immediately",
      "severity": "Low",
      "platform": "windows",
      "type": "command",
      "tags": ["services"],
      "check": { 
        "cmd": "powershell", 
        "args": ["Get-Service -Name XboxNetApiSvc | Select-Object -ExpandProperty Status"], 
        "expect_pattern": "Stopped" 
      },
      "remediation": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Set-Service -Name XboxNetApiSvc -StartupType Disabled; Stop-Service -Name XboxNetApiSvc -Force"] 
      },
      "rollback": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Set-Service -Name XboxNetApiSvc -StartupType Manual; Start-Service -Name XboxNetApiSvc"] 
      }
    },
    {
      "id": "WIN-5-a-i",
      "name": "Firewall Private State",
      "description": "Ensure Windows Firewall: Private: Firewall state is On",
      "severity": "Critical",
      "platform": "windows",
      "type": "command",
      "tags": ["firewall"],
      "check": { "cmd": "powershell", "args": ["Get-NetFirewallProfile -Profile Private | Select-Object -ExpandProperty Enabled"], "expect_pattern": "True" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Private -Enabled True"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Private -Enabled False"] }
    },
    {
      "id": "WIN-5-a-ii",
      "name": "Firewall Private Inbound",
      "description": "Ensure Windows Firewall: Private: Inbound connections is Block",
      "severity": "High",
      "platform": "windows",
      "type": "command",
      "tags": ["firewall"],
      "check": { "cmd": "powershell", "args": ["Get-NetFirewallProfile -Profile Private | Select-Object -ExpandProperty DefaultInboundAction"], "expect_pattern": "Block" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Private -DefaultInboundAction Block"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Private -DefaultInboundAction Allow"] }
    },
    {
      "id": "WIN-5-b-i",
      "name": "Firewall Public State",
      "description": "Ensure Windows Firewall: Public: Firewall state is On",
      "severity": "Critical",
      "platform": "windows",
      "type": "command",
      "tags": ["firewall"],
      "check": { "cmd": "powershell", "args": ["Get-NetFirewallProfile -Profile Public | Select-Object -ExpandProperty Enabled"], "expect_pattern": "True" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Public -Enabled True"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Public -Enabled False"] }
    },
    {
      "id": "WIN-5-b-ii",
      "name": "Firewall Public Inbound",
      "description": "Ensure Windows Firewall: Public: Inbound connections is Block",
      "severity": "High",
      "platform": "windows",
      "type": "command",
      "tags": ["firewall"],
      "check": { "cmd": "powershell", "args": ["Get-NetFirewallProfile -Profile Public | Select-Object -ExpandProperty DefaultInboundAction"], "expect_pattern": "Block" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Public -DefaultInboundAction Block"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Public -DefaultInboundAction Allow"] }
    },
    {
      "id": "WIN-6-a-i",
      "name": "Audit Credential Validation",
      "description": "Ensure Audit Credential Validation is Success and Failure",
      "severity": "Medium",
      "platform": "windows",
      "type": "command",
      "tags": ["audit_policy"],
      "check": { "cmd": "auditpol", "args": ["/get", "/subcategory:Credential Validation"], "expect_pattern": "Success and Failure" },
      "remediation": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:Credential Validation", "/success:enable", "/failure:enable"] },
      "rollback": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:Credential Validation", "/success:disable", "/failure:disable"] }
    },
    {
      "id": "WIN-6-a-ii",
      "name": "Audit Application Group",
      "description": "Ensure Audit Application Group Management is Success and Failure",
      "severity": "Medium",
      "platform": "windows",
      "type": "command",
      "tags": ["audit_policy"],
      "check": { "cmd": "auditpol", "args": ["/get", "/subcategory:Application Group Management"], "expect_pattern": "Success and Failure" },
      "remediation": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:Application Group Management", "/success:enable", "/failure:enable"] },
      "rollback": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:Application Group Management", "/success:disable", "/failure:disable"] }
    },
    {
      "id": "WIN-6-a-iii",
      "name": "Audit Security Group",
      "description": "Ensure Audit Security Group Management includes Success",
      "severity": "Medium",
      "platform": "windows",
      "type": "command",
      "tags": ["audit_policy"],
      "check": { "cmd": "auditpol", "args": ["/get", "/subcategory:Security Group Management"], "expect_pattern": "Success" },
      "remediation": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:Security Group Management", "/success:enable"] },
      "rollback": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:Security Group Management", "/success:disable"] }
    },
    {
      "id": "WIN-6-b-i",
      "name": "Disallow Autoplay",
      "description": "Ensure Disallow Autoplay for non-volume devices is Enabled",
      "severity": "Medium",
      "platform": "windows",
      "type": "registry",
      "tags": ["autoplay"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer", "reg_value": "NoAutoplayfornonVolume", "expected": 1 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer", "reg_value": "NoAutoplayfornonVolume", "value": 1 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer", "reg_value": "NoAutoplayfornonVolume", "value": 0 }
    },
    {
      "id": "WIN-7-a",
      "name": "AppGuard Auditing",
      "description": "Ensure Allow auditing events in Microsoft Defender Application Guard is Enabled",
      "severity": "Low",
      "platform": "windows",
      "type": "registry",
      "tags": ["app_guard"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Policies\\Microsoft\\AppHVSI", "reg_value": "AuditApplicationGuard", "expected": 1 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Policies\\Microsoft\\AppHVSI", "reg_value": "AuditApplicationGuard", "value": 1 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Policies\\Microsoft\\AppHVSI", "reg_value": "AuditApplicationGuard", "value": 0 }
    },
    {
      "id": "WIN-4-b-iii",
      "name": "Disable Computer Browser",
      "severity": "Low",
      "platform": "windows",
      "type": "registry",
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\Browser", "reg_value": "Start", "expected": 4 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\Browser", "reg_value": "Start", "value": 4 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\Browser", "reg_value": "Start", "value": 3 }
    },
    {
      "id": "WIN-4-b-iv",
      "name": "Disable Geolocation",
      "description": "Stop Geolocation Service immediately",
      "severity": "Low",
      "platform": "windows",
      "type": "command",
      "tags": ["services", "privacy"],
      "check": { 
        "cmd": "powershell", 
        "args": ["Get-Service -Name lfsvc | Select-Object -ExpandProperty Status"], 
        "expect_pattern": "Stopped" 
      },
      "remediation": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Set-Service -Name lfsvc -StartupType Disabled; Stop-Service -Name lfsvc -Force"] 
      },
      "rollback": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Set-Service -Name lfsvc -StartupType Manual; Start-Service -Name lfsvc"] 
      }
    },
    {
      "id": "WIN-4-b-v",
      "name": "Disable ICS",
      "severity": "High",
      "platform": "windows",
      "type": "registry",
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess", "reg_value": "Start", "expected": 4 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess", "reg_value": "Start", "value": 4 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess", "reg_value": "Start", "value": 2 }
    },
    {
      "id": "WIN-4-b-vii",
      "name": "Disable Remote Desktop Service",
      "severity": "High",
      "platform": "windows",
      "type": "registry",
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\TermService", "reg_value": "Start", "expected": 4 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\TermService", "reg_value": "Start", "value": 4 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\TermService", "reg_value": "Start", "value": 3 }
    },
    {
      "id": "WIN-4-b-xv",
      "name": "Disable Web Management Service",
      "severity": "Medium",
      "platform": "windows",
      "type": "registry",
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WMSvc", "reg_value": "Start", "expected": 4 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WMSvc", "reg_value": "Start", "value": 4 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WMSvc", "reg_value": "Start", "value": 3 }
    },
    {
      "id": "WIN-4-b-xvi",
      "name": "Disable Windows Error Reporting",
      "severity": "Low",
      "platform": "windows",
      "type": "registry",
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WerSvc", "reg_value": "Start", "expected": 4 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WerSvc", "reg_value": "Start", "value": 4 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WerSvc", "reg_value": "Start", "value": 2 }
    },
    {
      "id": "WIN-4-b-xxi",
      "name": "Disable WinRM",
      "severity": "High",
      "platform": "windows",
      "type": "registry",
      "check": { "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WinRM", "reg_value": "Start", "expected": 4 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WinRM", "reg_value": "Start", "value": 4 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SYSTEM\\CurrentControlSet\\Services\\WinRM", "reg_value": "Start", "value": 3 }
    },
    {
      "id": "WIN-5-a-iv",
      "name": "Firewall Private Notify",
      "severity": "Low",
      "platform": "windows",
      "type": "command",
      "check": { "cmd": "powershell", "args": ["Get-NetFirewallProfile -Profile Private | Select-Object -ExpandProperty NotifyOnListen"], "expect_pattern": "False" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Private -NotifyOnListen False"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Private -NotifyOnListen True"] }
    },
    {
      "id": "WIN-5-a-vii",
      "name": "Firewall Private Log Dropped",
      "severity": "Medium",
      "platform": "windows",
      "type": "command",
      "check": { "cmd": "powershell", "args": ["Get-NetFirewallProfile -Profile Private | Select-Object -ExpandProperty LogBlocked"], "expect_pattern": "True" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Private -LogBlocked True"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Private -LogBlocked False"] }
    },
    {
      "id": "WIN-5-b-iv",
      "name": "Firewall Public Notify",
      "severity": "Low",
      "platform": "windows",
      "type": "command",
      "check": { "cmd": "powershell", "args": ["Get-NetFirewallProfile -Profile Public | Select-Object -ExpandProperty NotifyOnListen"], "expect_pattern": "False" },
      "remediation": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Public -NotifyOnListen False"] },
      "rollback": { "type": "command", "cmd": "powershell", "args": ["Set-NetFirewallProfile -Profile Public -NotifyOnListen True"] }
    },
    {
      "id": "WIN-6-a-iv",
      "name": "Audit User Account Mgmt",
      "severity": "High",
      "platform": "windows",
      "type": "command",
      "check": { "cmd": "auditpol", "args": ["/get", "/subcategory:User Account Management"], "expect_pattern": "Success and Failure" },
      "remediation": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:User Account Management", "/success:enable", "/failure:enable"] },
      "rollback": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:User Account Management", "/success:disable", "/failure:disable"] }
    },
    {
      "id": "WIN-6-a-vi",
      "name": "Audit Process Creation",
      "severity": "Medium",
      "platform": "windows",
      "type": "command",
      "check": { "cmd": "auditpol", "args": ["/get", "/subcategory:Process Creation"], "expect_pattern": "Success" },
      "remediation": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:Process Creation", "/success:enable"] },
      "rollback": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:Process Creation", "/success:disable"] }
    },
    {
      "id": "WIN-6-a-ix",
      "name": "Audit File Share",
      "severity": "Medium",
      "platform": "windows",
      "type": "command",
      "check": { "cmd": "auditpol", "args": ["/get", "/subcategory:File Share"], "expect_pattern": "Success and Failure" },
      "remediation": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:File Share", "/success:enable", "/failure:enable"] },
      "rollback": { "type": "command", "cmd": "auditpol", "args": ["/set", "/subcategory:File Share", "/success:disable", "/failure:disable"] }
    },
    {
      "id": "WIN-4-b-xix",
      "name": "Disable Mobile Hotspot",
      "description": "Ensure Windows Mobile Hotspot Service is Disabled",
      "severity": "Medium",
      "platform": "windows",
      "type": "command",
      "tags": ["services", "network"],
      "check": { 
        "cmd": "powershell", 
        "args": ["Get-Service -Name icssvc | Select-Object -ExpandProperty Status"], 
        "expect_pattern": "Stopped" 
      },
      "remediation": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Set-Service -Name icssvc -StartupType Disabled; Stop-Service -Name icssvc -Force"] 
      },
      "rollback": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Set-Service -Name icssvc -StartupType Manual"] 
      }
    },
    {
      "id": "WIN-4-b-iv",
      "name": "Disable Geolocation",
      "description": "Stop Geolocation Service immediately",
      "severity": "Low",
      "platform": "windows",
      "type": "command",
      "tags": ["services", "privacy"],
      "check": { 
        "cmd": "powershell", 
        "args": ["Get-Service -Name lfsvc | Select-Object -ExpandProperty Status"], 
        "expect_pattern": "Stopped" 
      },
      "remediation": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Set-Service -Name lfsvc -StartupType Disabled; Stop-Service -Name lfsvc -Force"] 
      },
      "rollback": { 
        "type": "command", 
        "cmd": "powershell", 
        "args": ["Set-Service -Name lfsvc -StartupType Manual; Start-Service -Name lfsvc"] 
      }
    },
    {
      "id": "WIN-4-a-ii",
      "name": "UAC Secure Prompt",
      "description": "Enforce UAC prompt on Secure Desktop (Dimmed Screen)",
      "severity": "High",
      "platform": "windows",
      "type": "registry",
      "tags": ["uac"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "PromptOnSecureDesktop", "expected": 1 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "PromptOnSecureDesktop", "value": 1 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "PromptOnSecureDesktop", "value": 0 }
    },
    {
      "id": "WIN-3-b-vi",
      "name": "Logon Message Title",
      "description": "Set the Title of the Legal Notice popup",
      "severity": "Low",
      "platform": "windows",
      "type": "registry",
      "tags": ["security_options"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "LegalNoticeCaption", "expected": "WARNING" },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "LegalNoticeCaption", "value": "WARNING" },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System", "reg_value": "LegalNoticeCaption", "value": "" }
    },
    {
      "id": "WIN-6-b-iii",
      "name": "Turn off AutoPlay",
      "description": "Disable AutoPlay for all drives to prevent malware",
      "severity": "Medium",
      "platform": "windows",
      "type": "registry",
      "tags": ["autoplay"],
      "check": { "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer", "reg_value": "NoDriveTypeAutoRun", "expected": 255 },
      "remediation": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer", "reg_value": "NoDriveTypeAutoRun", "value": 255 },
      "rollback": { "type": "registry", "reg_key": "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer", "reg_value": "NoDriveTypeAutoRun", "value": 145 }
    }
  ]
}